---
# preflight steps
- name: Install packages
  ansible.builtin.dnf:
    state: latest
    name: "{{ packages }}"
  vars:
    packages:
    - mkisofs

- name: Check windows 11 pro iso image exists on the virtualization host
  ansible.builtin.stat:
    path: "/var/lib/libvirt/images/{{ windows_iso }}"
  register: file_stat

- name: Check if file exists
  ansible.builtin.fail:
    msg: "Pre-requisite not met: Cannot find {{ windows_iso }} in /var/lib/libvirt/images/ directory. Please download from microsoft software downloads."
  when: not file_stat.stat.exists
